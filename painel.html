<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel de Chamados RH | Pupa TerceirizaÃ§Ã£o</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Inter', sans-serif;
  background: #f1f5f9;
  margin: 0;
  color: #111;
}

/* ===== LOGIN ===== */
#login {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
  background: linear-gradient(180deg, #0b3d23, #062614);
}
.login-box {
  background: #fff;
  padding: 30px 40px;
  border-radius: 12px;
  box-shadow: 0 8px 30px rgba(0,0,0,.3);
  text-align: center;
  width: 300px;
}
.login-box h2 {
  color: #16a34a;
  margin-bottom: 15px;
}
.login-box input {
  width: 100%;
  padding: 10px;
  margin-top: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 15px;
}
.login-box button {
  margin-top: 20px;
  background: #16a34a;
  border: none;
  padding: 10px 20px;
  color: #fff;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  width: 100%;
}
.login-box button:hover {
  background: #138a3d;
}

/* ===== PAINEL ===== */
#painel { display: none; padding: 20px; }
header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #16a34a;
  color: #fff;
  padding: 12px 20px;
  border-radius: 8px;
  margin-bottom: 20px;
}
header h1 { font-size: 20px; }
header button {
  background: #fff;
  color: #16a34a;
  border: none;
  padding: 6px 14px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
}
header button:hover { background: #e5e7eb; }

/* ===== TABS ===== */
.tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}
.tab {
  padding: 8px 16px;
  border-radius: 6px;
  background: #e5e7eb;
  color: #111;
  font-weight: 500;
  cursor: pointer;
  transition: .3s;
}
.tab.active {
  background: #16a34a;
  color: #fff;
}

/* ===== TABELAS ===== */
table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 5px 20px rgba(0,0,0,.1);
}
th, td {
  padding: 10px 12px;
  text-align: left;
  border-bottom: 1px solid #e5e7eb;
}
th {
  background: #f9fafb;
  color: #333;
  font-weight: 600;
}
tr:hover { background: #f3f4f6; }
select {
  padding: 6px;
  border-radius: 6px;
  border: 1px solid #ccc;
}
button.arquivar {
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
  color: #16a34a;
  transition: .2s;
}
button.arquivar:hover { transform: scale(1.2); }

/* ===== POPUP ===== */
#popup {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #16a34a;
  color: #fff;
  padding: 14px 18px;
  border-radius: 10px;
  box-shadow: 0 8px 20px rgba(0,0,0,.3);
  display: none;
  font-weight: 500;
  animation: slideUp .5s ease forwards;
}
@keyframes slideUp {
  from {opacity: 0; transform: translateY(40px);}
  to {opacity: 1; transform: translateY(0);}
}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="login">
  <div class="login-box">
    <h2>Login RH</h2>
    <input type="password" id="senha" placeholder="Digite a senha">
    <button onclick="login()">Entrar</button>
    <p id="erro" style="color:red;display:none;margin-top:10px;">Senha incorreta</p>
  </div>
</div>

<!-- PAINEL -->
<div id="painel">
  <header>
    <h1>Painel de Chamados - RH</h1>
    <button onclick="logout()">Sair</button>
  </header>

  <div class="tabs">
    <div class="tab active" onclick="mudarAba('ativos')">Chamados Ativos</div>
    <div class="tab" onclick="mudarAba('arquivados')">Arquivados</div>
  </div>

  <table id="tabela">
    <thead>
      <tr>
        <th>Ticket</th>
        <th>Nome</th>
        <th>Filial</th>
        <th>Setor</th>
        <th>Assunto</th>
        <th>Mensagem</th>
        <th>Status</th>
        <th>AÃ§Ãµes</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- POPUP -->
<div id="popup">ðŸ”” Novo chamado recebido!</div>

<script>
// ===== LOGIN =====
const senhaCorreta = "rh2025";
function login(){
  const s = document.getElementById("senha").value;
  if(s === senhaCorreta){
    document.getElementById("login").style.display="none";
    document.getElementById("painel").style.display="block";
    carregarChamados();
  } else {
    document.getElementById("erro").style.display="block";
  }
}
function logout(){
  document.getElementById("painel").style.display="none";
  document.getElementById("login").style.display="flex";
  document.getElementById("senha").value="";
}

// ===== TABELAS =====
if(!localStorage.getItem("chamados"))
  localStorage.setItem("chamados", JSON.stringify([]));
if(!localStorage.getItem("arquivados"))
  localStorage.setItem("arquivados", JSON.stringify([]));

let abaAtual = "ativos";

function mudarAba(aba){
  abaAtual = aba;
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelector(`.tab:nth-child(${aba === 'ativos' ? 1 : 2})`).classList.add('active');
  carregarChamados();
}

function carregarChamados(){
  const dados = JSON.parse(localStorage.getItem(abaAtual === "ativos" ? "chamados" : "arquivados"));
  const tbody = document.querySelector("#tabela tbody");
  tbody.innerHTML = "";

  if(dados.length === 0){
    tbody.innerHTML = `<tr><td colspan="8" style="text-align:center;color:#666;">Nenhum chamado ${abaAtual === 'ativos' ? 'ativo' : 'arquivado'}.</td></tr>`;
    return;
  }

  dados.forEach((c, i)=>{
    const tr = document.createElement("tr");
    tr.style.transition = "all 0.4s ease";
    tr.innerHTML = `
      <td>${c.ticket}</td>
      <td>${c.nome}</td>
      <td>${c.filial}</td>
      <td>${c.setor}</td>
      <td>${c.assunto}</td>
      <td>${c.mensagem}</td>
      <td>
        ${abaAtual === "ativos" ? `
          <select onchange="atualizarStatus(${i}, this.value)">
            <option ${c.status==="Aguardando"?"selected":""}>Aguardando</option>
            <option ${c.status==="Em tratamento"?"selected":""}>Em tratamento</option>
            <option ${c.status==="Aguardando devolutiva"?"selected":""}>Aguardando devolutiva</option>
            <option ${c.status==="Finalizado"?"selected":""}>Finalizado</option>
          </select>` : c.status}
      </td>
      <td>
        ${abaAtual === "ativos" ? `<button class="arquivar" title="Arquivar chamado" onclick="arquivarChamado(${i}, this)">ðŸ“¦</button>` : ""}
      </td>`;
    tbody.appendChild(tr);
  });
}

function atualizarStatus(index, valor){
  const dados = JSON.parse(localStorage.getItem("chamados"));
  dados[index].status = valor;
  localStorage.setItem("chamados", JSON.stringify(dados));
  carregarChamados();
}

/* ===== ANIMAÃ‡ÃƒO + ALERTA DE ARQUIVAR ===== */
function arquivarChamado(index, btn){
  const tr = btn.closest("tr");
  tr.style.opacity = "0";
  tr.style.transform = "translateX(40px)";

  setTimeout(()=>{
    const chamados = JSON.parse(localStorage.getItem("chamados"));
    const arquivados = JSON.parse(localStorage.getItem("arquivados"));
    const movido = chamados.splice(index, 1)[0];
    movido.status = "Arquivado";
    arquivados.push(movido);
    localStorage.setItem("chamados", JSON.stringify(chamados));
    localStorage.setItem("arquivados", JSON.stringify(arquivados));
    carregarChamados();
    mostrarPopup("âœ… Chamado arquivado com sucesso!");
  }, 350);
}

/* ===== POPUP GERAL ===== */
function mostrarPopup(texto="ðŸ”” Novo chamado recebido!"){
  const pop = document.getElementById("popup");
  pop.innerText = texto;
  pop.style.background = texto.includes("arquivado") ? "#22c55e" : "#16a34a";
  pop.style.display="block";
  pop.style.opacity="1";
  setTimeout(()=>{
    pop.style.opacity="0";
    setTimeout(()=>pop.style.display="none", 500);
  }, 3000);
}

/* ===== DETECTOR DE NOVOS CHAMADOS ===== */
window.lastCount = JSON.parse(localStorage.getItem("chamados")).length;
setInterval(()=>{
  const novos = JSON.parse(localStorage.getItem("chamados"));
  if(novos.length > window.lastCount){
    mostrarPopup("ðŸ”” Novo chamado recebido!");
    if(abaAtual === "ativos") carregarChamados();
  }
  window.lastCount = novos.length;
}, 5000);
</script>

</body>
</html>
